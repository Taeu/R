#import
library(car);
library(leaps);
#/* open data file */
data.rey=dir("C:/Users/Taeu/Desktop/??????????????????/Reyeme1.txt");
dfile.rey=paste("C:/Users/Taeu/Desktop/??????????????????/Reyeme1.txt",data.rey,sep="");
drey=read.table(dfile.rey[1],head=TRUE,sep="\t");

# > names(drey)
#[1] "streetadress" [2]"unit"       [3]"area"     [4]"areacode"   [5]"firstprice"   [6]"lastprice"    [7]"saleprice"   
#[8] "firstdate"    "lastdate"     [10]"days"       [11]  "interior"     "bed"          "bath"         "room"        
#[15] "condo"       [16] "tax"      [17]  "rc" 
#/*step ?????? */


#???????????? ???????????? ???????????? regression ??? real data set
#1. firstdate ??? lastdate ??? days(duration)??? ??????????????? ?????????????????? ??????
#2. streetadress, area, areacode??? ???????????? ???????????? ?????? ?????? area factor????????? ??????
#3. interiror, bed, room, bath??? ??????????????? ?????? ??????
v1= lm(interior~bed+room+bath,data=drey); #????????? ?????? ??????
printf("vif(v1)\n");
vif(v1);
#4. firstprice??? lastprice??? ???????????? ????????? ????????? ??????????????? true saleprice??? ??????????????? ???????????? ??????????????? ??????
#?????? ????????? ?????? ???????????? ????????????
f1 = lm(saleprice ~ area+days+interior+bed+bath+condo+tax+rc,data=drey);
#scale
f1s = lm(log(saleprice) ~ area+days+interior+bed+bath+condo+tax+rc,data=drey);
summary(f1);
#step ??????
printf("step Analysis :\n");
step(f1s);
plot(f1s);
f2=lm(formula = log(saleprice) ~ area + days + interior + condo + tax, data = drey)# is best model from step(f1);
summary(f2);
extractAIC(f1);
extractAIC(f2);
# ????????? ??? ???????????? coefficient??? ??? ????????? ?????????????????? ????????? ??????,
newdrey=drey[c(3,7,10,11,15,16)];
f3=lm(log(saleprice)~.^2,data=newdrey);
summary(f3);
step(f3);
#summary f4f4=lm(formula = saleprice ~ area + days + interior + condo + tax + rc + area:interior + area:condo + area:tax + days:condo + interior:tax + condo:rc, data = newdrey)
f4=lm(formula = log(saleprice) ~ area + days + interior + condo + 
        tax + rc + area:interior + area:condo + area:tax + days:condo + 
        days:tax + interior:tax + condo:tax + condo:rc, data = newdrey)
summary(f4);
extractAIC(f3);
extractAIC(f4);
par(mfrow=c(2,2));
plot(f4);
outlierTest(f4); #49 is outlier


#BIC(f1);BIC(f2);BIC(f3);BIC(f4);
# firstprice lastprice ????????? ??????
testdrey=drey[c(3,5,6,7,10,11,15,16,17)]
step(lm(saleprice~.,data=testdrey))
f5=lm(formula = saleprice ~ area + firstprice + lastprice + condo + tax, data = testdrey)
summary(f5);
extractAIC(f5);
vif(f5);
vif(lm(saleprice~.,data=testdrey))
#??????????????? firstprice??? lastprice??? ?????????????????? ?????? ???????????? ?????????.