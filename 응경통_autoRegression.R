#20150774_?????????_?????????
#?????? library import
library(car);
library(leaps);
# data set 
MT =mtcars;
step(lm(mpg~.,data=MT)); #AIC = 61.31
f1 = lm(formula = mpg ~ wt + qsec + am, data = MT);
summary(f1);??? 
vif(f1); # ????????????????????? ?????? ??????
par(mfrow=c(2,2)); # outlier, influential data check
outlierTest(f1); #outlier??? ?????? ??????.

# however auto and manual are originally categorical variables.
# There are some distorted coefficients Beta. also there are some correlation effects of auto or manual with other variables.
# Therefore, we should change numeric variables to categorical variables or seperate datas, auto and manual.

# 1. classify data to auto and manual

MTauto=MT[MT$am==0,];
MTmanual=MT[MT$am==1,];
MTauto=MTauto[,-9]; # delete am column vector
MTmanual=MTmanual[,-9]; # delete am column vector
step(lm(formula=mpg~.,data=MTauto));
step(lm(formula=mpg~.,data=MTmanual));
f2=lm(formula = mpg ~ disp + hp + gear + carb, data = MTauto);
f3=lm(formula = mpg ~ disp + hp + drat + wt + qsec + gear + carb, data = MTmanual);
par(mfrow=c(2,4));
plot(f2); # ??? ????????? ??????
plot(f3);
outlierTest(f2); #outlier ?????? ??????
outlierTest(f3);
vif(f2); # ??????????????? ???
vif(f3); 
f2=lm(formula = mpg ~ disp + gear + carb, data = MTauto);
f3=lm(formula = mpg ~ hp + drat + wt + qsec + gear + carb, data = MTmanual);
vif(f2); #????????????
vif(f3); # ????????? ??????
f3=lm(formula = mpg ~ + drat + wt + gear + carb, data = MTmanual)
vif(f3); # ????????????
par(mfrow=c(2,4));
plot(f2); # ??? ????????? ??????
plot(f3);
# ??????????????? ??????
f22=lm(formula = mpg ~ (disp + hp + gear + carb)^2, data = MTauto);
step(f22);
f222=lm(formula = mpg ~ gear + carb, data = MTauto);
extractAIC(f2);extractAIC(f22);extractAIC(f222);
f33=lm(formula = mpg ~ (disp + hp + drat + wt + qsec + gear + carb)^2, data = MTmanual);
step(f33); # ??? ????????? ??? ??????
extractAIC(f3);extractAIC(f33)
# ???????????? f222, f3;

# 2. change numeric to categorical vari.
# ????????? ??????????????? auto ??? t, manual?????? f??? ?????????
data.MT=dir("C:/Users/Taeu/Desktop/??????????????????/mtcars.txt");
dfile.MT=paste("C:/Users/Taeu/Desktop/??????????????????/mtcars.txt",data.MT,sep="");
MT2=read.table(dfile.MT[1],head=TRUE,sep=" ");